load("~/sc_mixology/data/sincell_with_class.RData")
packages.install("BiocLite")
install.packages("BiocLite")
install.packages("BiocManager")
BiocManager::install("SingleCellExperiment")
library(dplyr)
library(Seurat)
library(SingleCellExperiment)
setwd("~/advanced-bioinformatics/")
load("data/sincell_with_class.RData")
# Pipe the 10x dataset through the regular PCA pipeline in Seurat
seurat_10x_qc <- sce_sc_10x_qc %>%
as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
rm(sce_sc_10x_qc) # Save memory
# Pipe the CELLseq2 dataset through the regular PCA pipeline in Seurat
seurat_CELseq2_qc <- sce_sc_CELseq2_qc %>%
as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
rm(sce_sc_CELseq2_qc) # Save memory
# Pipe the Dropseq dataset through the regular PCA pipeline in Seurat
seurat_Dropseq_qc <- sce_sc_Dropseq_qc %>%
as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
rm(sce_sc_Dropseq_qc) # Save memory
# Some PCA plots
plot_10x_qc <- DimPlot(seurat_10x_qc, reduction = "pca", group.by = "cell_line")
plot_CELseq2_qc <- DimPlot(seurat_CELseq2_qc, reduction = "pca", group.by = "cell_line")
plot_Dropseq_qc <- DimPlot(seurat_Dropseq_qc, reduction = "pca", group.by = "cell_line")
# Output the plots into images
png("output/3-cell-line-10x-pca-seurat", height = 1000, width = 1000)
plot_10x_qc
dev.off()
png("output/3-cell-line-CELseq2-pca-seurat", height = 1000, width = 1000)
plot_CELseq2_qc
dev.off()
png("output/3-cell-line-Dropseq-pca-seurat", height = 1000, width = 1000)
plot_Dropseq_qc
dev.off()
