load("~/sc_mixology/data/sincell_with_class.RData")
packages.install("BiocLite")
install.packages("BiocLite")
install.packages("BiocManager")
BiocManager::install("SingleCellExperiment")
Ncpus
parallel::detectCores()
options(Ncpus = 4)
BiocManager::install("Seurat")
install.packages("plotly")
install.packages("plotly")
BiocManager::install("Seurat")
setwd("~/advanced-bioinformatics/")
load("data/sincell_with_class.RData"))
load("data/sincell_with_class.RData")
counts(sce_sc_10x_qc)[1:5, 1:5]
counts(sce_sc_CELseq2_qc)[1:5, 1:5]
counts(sce_sc_10x_qc)[1:5, 1:5]
counts(sce_sc_10x_qc)[1:5, 1:5]
counts(sce_sc_10x_qc)[1:5, 1:5]
counts(sce_sc_CELseq2_qc)[1:5, 1:5]
counts(sce_sc_10x_qc)[1:5, 1:5]
clear
head(colData(sce_sc_10x_qc))
View(sce_sc_Dropseq_qc)
Convert.SingleCellExperiment(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
library(Convert)
library(Seurat)
library(SingleCellExperiment)
library(Convert)
Convert.SingleCellExperiment(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
convert.SingleCellExperiment(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
install.packages("scater")
BiocManager::install("scater")
library(scater)
library(Seurat)
Convert.SingleCellExperiment(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
Convert(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
sce <- Convert(from = sce, to = 'seurat', raw.data.slot = "counts", data.slot = "logcounts")
sce_10x_seurat <- as.Seurat(sce_sc_10x_qc)
View(sce_10x_seurat)
sce_10x_seurat <- as.Seurat(sce_sc_10x_qc, counts = "counts", data = "logcounts")
sce_10x_seurat <- runPCA(sce_10x_seurat)
sce_10x_seurat <- RunPCA(sce_10x_seurat)
sce_10x_seurat <- FindVariableFeatures(sce_10x_seurat)
sce_10x_seurat <- RunPCA(sce_10x_seurat)
sce_10x_seurat <- ScaleData(sce_10x_seurat)
sce_10x_seurat <- RunPCA(sce_10x_seurat)
library(dplyr)
library(Seurat)
library(SingleCellExperiment)
library(Convert)
sce_10x_seurat <- as.Seurat(sce_sc_10x_qc, counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA
sce_10x_seurat <- as.Seurat(sce_sc_10x_qc, counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat <- as.Seurat(sce_sc_10x_qc, counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat %>% as.Seurat(sce_sc_10x_qc, counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(sce_10x_qc, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(sce_10x_qc, reduction = "PCA", group.by = "Source") + NoLegend()
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
View(sce_10x_seurat)
rm(sce_10x_seurat)
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat <- runPCA(sce_10x_seurat)
sce_10x_seurat <- RunPCA(sce_10x_seurat)
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA(VariableFeatures(object = sce_10x_seurat))
p1 <- DimPlot(sce_10x_seurat, reduction = "PCA", group.by = "Source") + NoLegend()
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA(VariableFeatures())
sce_10x_seurat <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
print(sce_10x_seurat[["pca"]], dims = 1:5, nfeatures = 5)
p1 <- DimPlot(sce_10x_seurat, reduction = "pca", group.by = "Source") + NoLegend()
p1 <- DimPlot(sce_10x_seurat, reduction = "pca") + NoLegend()
p1
View(p1)
View(sce_10x_seurat)
p1 <- DimPlot(sce_10x_seurat, reduction = "pca", group.by = "cell_line") + NoLegend()
p1
p1 <- DimPlot(sce_10x_seurat, reduction = "pca", group.by = "cell_line")
p1
seurat_10x_qc <- sce_sc_10x_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
rm(sce_10x_seurat)
seurat_CELseq2_qc <- sce_sc_CELseq2_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
seurat_Dropseq_qc <- sce_sc_Dropseq_qc %>% as.Seurat(counts = "counts", data = "logcounts") %>%
FindVariableFeatures() %>% ScaleData() %>% RunPCA()
p1 <- DimPlot(seurat_10x_qc, reduction = "pca", group.by = "cell_line")
p2 <- DimPlot(seurat_CELseq2_qc, reduction = "pca", group.by = "cell_line")
p3 <- DimPlot(seurat_Dropseq_qc, reduction = "pca", group.by = "cell_line")
p1
p2
p3
